<?xml version="1.0" encoding="UTF-8"?>
<container xmlns="http://www.nonsoft.com/JADE/1.0" name="/web" abortOnError="true">
	<components>
		<!-- DAO support -->
		<component key="com.nonsoft.persistence.IDAO" class="com.nonsoft.persistence.hibernate3.HibernateDAOSupport" scope="container">
			<property name="sessionManager" />
		</component>

		<!-- Auth service and password store -->
		<component class="com.nonsoft.access.authentication.CryptAuthenticationService" scope="container">
			<property name="passwordStore" />
		</component>
		<component class="com.nonsoft.access.authentication.MemoryPasswordStore" scope="container">
			<property name="passwords">
				<map>
					<entry key="admin">
						<value>$apr1$rf4.....$.LbV5qxK0Vu/9h/QTCKlw0</value>
					</entry>
				</map>
			</property>
		</component>
		<!--
			<component class="com.nonsoft.access.FilePasswordStore" scope="container">
			<property name="passwordFilePath">
			<value>passwd</value>
			</property>
			</component>
		-->
		<!-- Access services -->
		<component class="com.nonsoft.access.web.AccessExceptionHandler" scope="container">
			<property name="config"/>
			<property name="requestHandler" />
			<property name="loginPage" value="/login.htm" />
		</component>
		
		<component class="com.nonsoft.access.web.AccessService" scope="container">
			<property name="runtimeHelperProvider" />
			<property name="authService" />
			<property name="runtime" autowire="byName" proxy="true" />
		</component>

		<!-- Filte rservice -->
		<component class="com.nonsoft.discuss.filter.FilterService" scope="container">
			<property name="filters">
				<list>
					<component class="com.nonsoft.discuss.filter.RadeoxContentFilter"></component>
					<!-- component class="com.nonsoft.discuss.filter.DefaultContentFilter"></component  -->
				</list>
			</property>
		</component>
	</components>
	
	<aspects>
		<pointcut interface="com.nonsoft.discuss.domain.IContent"
			methodAttribute="com.nonsoft.discuss.filter.ApplyFilter" methodPattern="^getBody$|^getTitle$" scope="instance">
			<interceptor-ref>contentInterceptor</interceptor-ref>
		</pointcut>
	</aspects>
	
	<advices>
		<interceptor key="contentInterceptor" class="com.nonsoft.discuss.filter.ContentInterceptor" scope="container">
			<!-- property name="cache" value="true"/ -->
		</interceptor>
	</advices>
</container>